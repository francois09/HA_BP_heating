blueprint:
  name: Light control
  description: Control light using daylight, occupancy and switch
  domain: automation
  source_url: https://github.com/francois09/HA_blueprints/light_control.yaml
  input:
    motion_sensor:
      name: Motion sensor of the room
      selector:
        entity:
          domain: binary_sensor
    light_device:
      name: Light management device
      selector:
        entity:
          domain: light
    is_window:
      name: Is there a window in the room
      description: Is there a window, allowing external light to enter ?
      default: True
      selector:
        boolean:

variables:
  local_light_device: !input light_device

mode: single
max_exceeded: silent

trigger:
- platform: state
  entity_id: !input motion_sensor
- platform: state
  entity_id: !input light_device

action:
- choose:
  - conditions:
    - condition: state
      entity_id: !input motion_sensor
      state: 'is_no_motion'
    sequence:
    - service: light.turn_off
      data: {}
      target:
        entity_id: "{{ local_light_device.entity_id }}"
        device_id: "{{ local_light_device.device_id }}"
  - conditions:
    - condition: state
      entity_id: !input motion_sensor
      state: 'motion'
    sequence:
    - service: light.turn_on
      data:
        brightness: 100
      target:
        entity_id: "{{ local_light_device.entity_id }}"
        device_id: "{{ local_light_device.device_id }}"
